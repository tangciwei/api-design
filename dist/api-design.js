module.exports=function(n){var e={};function t(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return n[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=n,t.c=e,t.d=function(n,e,o){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:o})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var i in n)t.d(o,i,function(e){return n[e]}.bind(null,i));return o},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="/dist/",t(t.s=0)}([function(n,e,t){function o(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var i=t(1),r=t(2),a="local",c="prod",u="login";n.exports=function(n){var e=n.hooks,t=n.config,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&t){var l=(t=Object.assign({},{method:"post",dataType:"json",timeout:3e4,silent:!1},t)).api,s=f.config,v=function(n,e){var t,i=c,r=[a,c],u=(o(t={},c,e),o(t,a,e),t);if(n){n.api;var f=n.env;u=Object.assign({},u,n.envHost),r=Object.keys(u),f&&f!==a&&f!==c&&(e=u[i=f])}return{env:i,host:e,envList:r,envHost:u}}(s,t.host),h=v.env,d=(v.host,v.envList,v.envHost),b=function(n){var e=Object.assign({},n);return delete e.api,delete e.code,e}(t),p={};Object.keys(l).forEach(function(n){var e=T(n,l[n]),t=e.env;p[n]=H(e,t)});var g=e.requestBefore,y=e.request,m=e.requestAfter,k=e.successHandle,j=e.errorHandle,O=e.timeoutHandle,w=e.loadingUi,P=0,x=!1;return{api:p,event:i}}function T(n,e){var t=h,o=d[h],i=e.login;if(s&&s.api&&s.api[n]){t=s.api[n].env||h,o=d[t];var r=s.api[n].login;void 0!==r&&(i=r)}var a={host:o};return void 0!==i&&(a.login=i),{env:t,config:Object.assign({},b,e,a)}}function H(n,e){return function(o,c){var l={},s=null;return n.config=Object.assign({},n.config,c),new Promise(function(c,v){var h={data:o,config:n.config};l={data:o,config:n.config};function d(){clearTimeout(s),s=null,l.config.silent||--P<=0&&(P=0,x=!1,w&&w(!1,l)),m&&m(l)}function b(n){(l.config.silent||(P++,x||(w(!0,l),x=!0)),s=setTimeout(function(){var e=O&&O(n,l);v(e)},h.config.timeout),e===a?new Promise(function(n,e){var t=f.mock[apiName];"function"==typeof t&&r(h,n,e,t)}):y(n,l)).then(function(n){return d(),n},function(n){throw d(),n}).then(function(n){return k?k(n,l):n}).then(function(n){c(n)}).catch(function(n){p(n)})}function p(n){var e=j&&j(n,t.code,l)||n;v(e)}(function(n){return new Promise(function(e,t){if(g){var o=g(n,l);o.then?o.then(function(n){e(n)},function(n){t(n)}):e(o)}else e(n)})})(h).then(function(n){!0!==h.config.login||i.login?b(n):i.listen(u,function(e){e&&b(n),i.login=e})},function(n){p(n)})})}}console.error("请配置hooks和config")}},function(n,e){function t(n,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}var o=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.callbacks={},this.login=e}var e,o,i;return e=n,(o=[{key:"notify",value:function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),o=1;o<e;o++)t[o-1]=arguments[o];var i=this.callbacks[n];i&&i.forEach(function(n){n.apply(void 0,t)})}},{key:"listen",value:function(n,e){this.callbacks[n]||(this.callbacks[n]=[]),this.callbacks[n].push(e)}},{key:"unlisten",value:function(n,e){if(2===arguments.length){if(this.callbacks[n]){var t=this.callbacks[n].indexOf(e);-1!==t&&this.callbacks[n].splice(t,1)}}else this.callbacks[n]&&(this.callbacks[n]=[])}}])&&t(e.prototype,o),i&&t(e,i),n}();n.exports=new o},function(n,e){function t(n,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}function o(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function n(e){var t=e.method,i=e.body;o(this,n),this.body=i,this.method=t},r=function(){function n(e,t){o(this,n),this.resolve=e,this.reject=t}var e,i,r;return e=n,(i=[{key:"send",value:function(n){this.resolve(JSON.parse(n))}}])&&t(e.prototype,i),r&&t(e,r),n}();n.exports=function(n,e,t,o){var a=n.data,c=n.config.method;o(new i({method:c,body:a}),new r(e,t))}}]);